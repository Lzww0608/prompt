# 📊 职场与生产力 - Excel 公式生成

## 常用公式生成

**描述：** 根据需求生成 Excel 公式

```
你是一名 Excel 专家。请帮我生成以下 Excel 公式：

**需求描述：**
[请用自然语言描述你想要实现的功能]

**数据结构：**
- 数据位置：[例如：A1:B100]
- 列说明：[说明各列的含义]

**输出位置：**
[说明公式要放置的位置]

**要求：**
1. 生成准确的 Excel 公式
2. 使用最优的函数组合
3. 考虑公式性能
4. 提供公式的详细解释
5. 如有多种实现方式，提供对比
6. 包容性考虑（处理空值、错误值等）

**输出格式：**
请输出：
- Excel 公式：`=公式`
- 公式解释：[逐步说明公式各部分的作用]
- 使用示例：[示例数据和结果]

请输出完整的 Excel 公式。
```

## 复杂公式设计

**描述：** 设计多条件、多步骤的复杂公式

```
你是一名 Excel 高级专家。请帮我设计以下复杂公式：

**功能需求：**
[详细描述需要实现的功能]

**数据结构：**
[说明数据表的列结构]

**条件要求：**
- 条件 1：[描述]
- 条件 2：[描述]
- 条件 3：[描述]

**输出要求：**
[说明输出的格式和要求]

**要求：**
1. 设计高效的公式方案
2. 提供多种实现方式（如数组公式、Power Query、VBA）
3. 说明每种方案的优缺点
4. 考虑数据量对性能的影响
5. 提供可维护性建议
6. 包含错误处理

**输出格式：**
请输出：
### 方案一：[方案名称]
**公式：** `=公式`
**适用场景：** [说明]
**优缺点：** [分析]

### 方案二：[方案名称]
**公式：** `=公式`
**适用场景：** [说明]
**优缺点：** [分析]

### 推荐方案
**推荐：** [方案名称]
**理由：** [说明]

请输出完整的公式设计方案。
```

## 数据统计公式

**描述：** 生成各种统计和分析公式

```
你是一名数据分析专家。请帮我生成统计公式：

**统计需求：**
[说明需要进行的统计分析]

**数据范围：**
[说明数据的位置和范围]

**统计要求：**
- [统计类型 1]
- [统计类型 2]
- [统计类型 3]

**要求：**
1. 生成多种统计公式（求和、平均值、计数、标准差等）
2. 支持条件统计
3. 生成分组统计公式
4. 提供数据透视表替代方案
5. 说明统计指标的含义
6. 提供可视化建议

**输出格式：**
请输出：
### 基础统计
| 统计项 | 公式 | 说明 |
|--------|------|------|
| 总和 | `=公式` | [说明] |
| 平均值 | `=公式` | [说明] |
| 计数 | `=公式` | [说明] |

### 条件统计
| 条件 | 公式 | 说明 |
|------|------|------|
| [条件1] | `=公式` | [说明] |
| [条件2] | `=公式` | [说明] |

### 进阶统计
[更复杂的统计公式]

### 可视化建议
[建议的图表类型]

请输出完整的统计公式。
```

## 文本处理公式

**描述：** 处理和提取文本数据的公式

```
你是一名 Excel 文本处理专家。请帮我生成文本处理公式：

**文本数据：**
[说明文本数据的位置和格式]

**处理需求：**
[详细说明需要对文本进行的处理]

**示例数据：**
[提供示例文本或数据]

**要求：**
1. 提供多种文本处理方案
2. 使用文本函数（LEFT, RIGHT, MID, FIND, SUBSTITUTE 等）
3. 支持正则表达式（如适用）
4. 考虑不同格式和边界情况
5. 提供分步处理方案
6. 说明公式的兼容性

**输出格式：**
请输出：
### 需求一：[需求描述]
**公式：** `=公式`
**说明：** [解释公式原理]
**示例：** [输入] → [输出]

### 需求二：[需求描述]
**公式：** `=公式`
**说明：** [解释公式原理]
**示例：** [输入] → [输出]

### 综合方案
如需多个步骤完成，提供分步方案。

请输出完整的文本处理公式。
```

## 日期时间公式

**描述：** 处理日期和时间的公式

```
你是一名 Excel 日期时间专家。请帮我生成日期时间公式：

**日期数据：**
[说明日期数据的位置和格式]

**计算需求：**
[详细说明需要的日期时间计算]

**示例：**
[提供示例日期和预期结果]

**要求：**
1. 生成准确的日期时间计算公式
2. 处理工作日和节假日
3. 计算日期差、工作日数
4. 格式化日期显示
5. 处理不同日期格式
6. 说明常见日期函数的使用

**输出格式：**
请输出：
### 基础计算
| 计算 | 公式 | 说明 |
|------|------|------|
| 日期差 | `=公式` | [说明] |
| 月份差 | `=公式` | [说明] |
| 工作日数 | `=公式` | [说明] |

### 日期提取
| 提取 | 公式 | 说明 |
|------|------|------|
| 年份 | `=公式` | [说明] |
| 月份 | `=公式` | [说明] |
| 星期几 | `=公式` | [说明] |

### 日期转换
[格式转换公式]

### 注意事项
[说明常见的日期处理注意事项]

请输出完整的日期时间公式。
```

## 动态数组公式

**描述：** 使用 Excel 新的动态数组功能

```
你是一名 Excel 动态数组专家。请帮我生成动态数组公式：

**数据源：**
[说明数据的位置和结构]

**功能需求：**
[详细说明需要实现的功能]

**Excel 版本：**
[说明使用的 Excel 版本，确保支持动态数组]

**要求：**
1. 使用动态数组函数（FILTER, SORT, UNIQUE, SEQUENCE 等）
2. 提供传统的替代方案
3. 说明动态数组的优势
4. 处理溢出错误
5. 提供组合使用多个动态函数的方案
6. 说明向后兼容性

**输出格式：**
请输出：
### 动态数组方案
**公式：** `=公式`
**说明：** [解释动态数组的工作原理]
**优势：** [列优势]

### 传统替代方案
**公式：** `=公式`
**说明：** [如何用传统函数实现]
**限制：** [传统方案的限制]

### 实际应用
| 场景 | 动态公式 | 传统公式 |
|------|----------|----------|
| [场景1] | `=公式` | `=公式` |
| [场景2] | `=公式` | `=公式` |

请输出完整的动态数组公式方案。
```

